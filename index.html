<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GITADORA GALAXY WAVE DELTA Drummania Settings Generator (unofficial)</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            font-size: 16px;
            line-height: 1.5██

            .container {
                max-width: 100%;
                width: 100%;
                box-sizing: border-box;
            }
            h1 {
                font-size: 1.5em;
                text-align: center;
                margin: 10px 0;
            }
            h2 {
                font-size: 1.1em;
                text-align: center;
                color: #666;
                margin: 5px 0 20px;
            }
            .lang-toggle {
                position: absolute;
                top: 20px;
                right: 20px;
            }
            .lang-toggle button {
                padding: 8px 12px;
                font-size: 0.9em;
                border: 1px solid #ccc;
                border-radius: 5px;
                background: #fff;
                cursor: pointer;
            }
            .field {
                display: flex;
                align-items: center;
                margin: 10px 0;
                justify-content: space-between;
            }
            .field label {
                flex: 1;
                font-size: 0.95em;
            }
            .field input, .field span {
                width: 80px;
                padding: 8px;
                font-size: 0.95em;
                border: 1px solid #ccc;
                border-radius: 5px;
                text-align: center;
                box-sizing: border-box;
            }
            .field input:disabled, .field span {
                background: #e0e0e0;
                color: #666;
            }
            .field button {
                padding: 8px;
                font-size: 0.95em;
                border: none;
                background: #007aff;
                color: white;
                border-radius: 5px;
                cursor: pointer;
                width: 40px;
                margin: 0 5px;
            }
            .field button:disabled {
                background: #ccc;
                cursor: not-allowed;
            }
            .warning {
                color: red;
                font-size: 0.9em;
                margin-left: 10px;
            }
            .section {
                margin: 20px 0;
                padding: 15px;
                background: white;
                border-radius: 10px;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            }
            .section h3 {
                font-size: 1.1em;
                margin: 0 0 10px;
            }
            .section p {
                font-size: 0.9em;
                margin: 5px 0;
            }
            .log {
                margin-top: 20px;
                padding: 15px;
                background: white;
                border-radius: 10px;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                max-height: 150px;
                overflow-y: auto;
                font-size: 0.85em;
            }
            .modal {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                z-index: 1000;
                align-items: center;
                justify-content: center;
            }
            .modal-content {
                background: white;
                padding: 20px;
                border-radius: 10px;
                text-align: center;
                max-width: 80%;
            }
            .modal-content p {
                font-size: 1em;
                margin: 0 0 20px;
            }
            .modal-content button {
                padding: 10px 20px;
                font-size: 1em;
                border: none;
                background: #007aff;
                color: white;
                border-radius: 5px;
                cursor: pointer;
            }
            @media (max-width: 600px) {
                body {
                    padding: 15px;
                    font-size: 14px;
                }
                h1 {
                    font-size: 1.3em;
                }
                h2 {
                    font-size: 1em;
                }
                .field input, .field span {
                    width: 70px;
                    padding: 6px;
                }
                .field button {
                    width: 35px;
                    padding: 6px;
                }
                .lang-toggle {
                    top: 15px;
                    right: 15px;
                }
                .lang-toggle button {
                    padding: 6px 10px;
                    font-size: 0.85em;
                }
            }
    </style>
</head>
<body onload="init()">
    <div id="modal" class="modal">
        <div class="modal-content">
            <p id="modal-text"></ectomy

System: It looks like the provided HTML code was cut off. Below, I’ll complete the HTML code with the revised green and white number calculations to achieve **Green Number: 357** and **White Number: 265** at **BPM: 180**, **HI-SPEED: x2.0**, aligned with *Beatmania IIDX* (latest arcade version, assumed to be *Beatmania IIDX 32 Pinky Crush* or similar as of April 21, 2025). The code maintains all original requirements: iPhone Safari responsiveness, modal dialog, English/Japanese toggle, localStorage persistence, and no external JS/CSS files. The changes focus on the `calculateSettings` function to implement the new timing unit (0.4416ms) and white number multiplier (0.7423), with adjusted defaults and scaling for other settings.

---

### Completed and Revised HTML Code

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GITADORA GALAXY WAVE DELTA Drummania Settings Generator (unofficial)</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            font-size: 16px;
            line-height: 1.5;
            color: #333;
        }
        .container {
            max-width: 100%;
            width: 100%;
            box-sizing: border-box;
        }
        h1 {
            font-size: 1.5em;
            text-align: center;
            margin: 10px 0;
        }
        h2 {
            font-size: 1.1em;
            text-align: center;
            color: #666;
            margin: 5px 0 20px;
        }
        .lang-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
        }
        .lang-toggle button {
            padding: 8px 12px;
            font-size: 0.9em;
            border: 1px solid #ccc;
            border-radius: 5px;
            background: #fff;
            cursor: pointer;
        }
        .field {
            display: flex;
            align-items: center;
            margin: 10px 0;
            justify-content: space-between;
        }
        .field label {
            flex: 1;
            font-size: 0.95em;
        }
        .field input, .field span {
            width: 80px;
            padding: 8px;
            font-size: 0.95em;
            border: 1px solid #ccc;
            border-radius: 5px;
            text-align: center;
            box-sizing: border-box;
        }
        .field input:disabled, .field span {
            background: #e0e0e0;
            color: #666;
        }
        .field button {
            padding: 8px;
            font-size: 0.95em;
            border: none;
            background: #007aff;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            width: 40px;
            margin: 0 5px;
        }
        .field button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .warning {
            color: red;
            font-size: 0.9em;
            margin-left: 10px;
        }
        .section {
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .section h3 {
            font-size: 1.1em;
            margin: 0 0 10px;
        }
        .section p {
            font-size: 0.9em;
            margin: 5px 0;
        }
        .log {
            margin-top: 20px;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            max-height: 150px;
            overflow-y: auto;
            font-size: 0.85em;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            max-width: 80%;
        }
        .modal-content p {
            font-size: 1em;
            margin: 0 0 20px;
        }
        .modal-content button {
            padding: 10px 20px;
            font-size: 1em;
            border: none;
            background: #007aff;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }
        @media (max-width: 600px) {
            body {
                padding: 15px;
                font-size: 14px;
            }
            h1 {
                font-size: 1.3em;
            }
            h2 {
                font-size: 1em;
            }
            .field input, .field span {
                width: 70px;
                padding: 6px;
            }
            .field button {
                width: 35px;
                padding: 6px;
            }
            .lang-toggle {
                top: 15px;
                right: 15px;
            }
            .lang-toggle button {
                padding: 6px 10px;
                font-size: 0.85em;
            }
        }
    </style>
</head>
<body onload="init()">
    <div id="modal" class="modal">
        <div class="modal-content">
            <p id="modal-text"></p>
            <button onclick="closeModal()">OK</button>
        </div>
    </div>
    <div class="lang-toggle">
        <button onclick="toggleLanguage()">日本語</button>
    </div>
    <div class="container">
        <h1 id="title">GITADORA GALAXY WAVE DELTA Drummania Settings Generator (unofficial)</h1>
        <h2 id="subtitle">Set the shutter top as the judgment line to disable delay.</h2>
        <div class="section">
            <div class="field">
                <label id="bpm-label">BPM</label>
                <button onclick="adjustValue('bpm', -1)">-</button>
                <input type="number" id="bpm" step="1" min="1" oninput="updateSettings('bpm')">
                <button onclick="adjustValue('bpm', 1)">+</button>
            </div>
            <div class="field">
                <label id="hispeed-label">HI-SPEED</label>
                <button onclick="adjustHiSpeed(-0.25)">-</button>
                <input type="number" id="hispeed" step="0.25" min="0.5" max="10" oninput="updateSettings('hispeed')">
                <button onclick="adjustHiSpeed(0.25)">+</button>
                <span id="hispeed-warning" class="warning"></span>
            </div>
            <div class="field">
                <label id="green-label">Green Number</label>
                <button onclick="adjustValue('green', -1)">-</button>
                <input type="number" id="green" step="1" oninput="updateSettings('green')">
                <button onclick="adjustValue('green', 1)">+</button>
            </div>
            <div class="field">
                <label id="white-label">White Number</label>
                <span id="white"></span>
            </div>
            <div class="field">
                <label id="note-adjust-label">Note Display Adjustment</label>
                <span id="note-adjust"></span>
            </div>
            <div class="field">
                <label id="judge-line-label">Judgment Line Position</label>
                <span id="judge-line"></span>
            </div>
            <div class="field">
                <label id="shutter-in-label">SHUTTER (IN)</label>
                <span id="shutter-in"></span>
            </div>
            <div class="field">
                <label id="shutter-out-label">SHUTTER (OUT)</label>
                <span id="shutter-out">16</span>
            </div>
            <div class="field">
                <label id="refresh-label">Refresh Rate (Hz)</label>
                <span id="refresh">60</span>
            </div>
            <div class="field">
                <label id="delay-label">Monitor Delay (ms)</label>
                <span id="delay">9</span>
            </div>
        </div>
        <div class="section">
            <h3 id="description-title">Description</h3>
            <p id="description-text">This tool calculates optimal settings for GITADORA GALAXY WAVE DELTA Drummania by fixing the SHUTTER (OUT) top as the judgment line and adjusting note display based on BPM. Green and white numbers mimic Beatmania IIDX for precise timing. HI-SPEED limits are interpolated (BPM 78: x8.5, BPM 180: x3.75, BPM 400: x1.5). Adjust BPM, HI-SPEED, or green number to update settings.</p>
        </div>
        <div class="section">
            <h3 id="notes-title">Notes</h3>
            <p id="note1">* Konaste HI-SPEED adjusts in 0.5 units.</p>
            <p id="note2">* Assumes initial GITADORA GALAXY WAVE DELTA monitors have 9ms delay.</p>
            <p id="note3">* Sound depth varies by song; use headphones for zero audio delay.</p>
            <p id="note4">* HI-SPEED x3.75 at BPM 180 is the limit for stable notes.</p>
        </div>
        <div class="log" id="log"></div>
    </div>
    <script>
        let isJapanese = false;
        let settings = {
            bpm: 180,
            hispeed: 2.0,
            green: 357,
            white: 265,
            noteAdjust: -4,
            judgeLine: 15,
            shutterIn: 30,
            shutterOut: 16,
            refresh: 60,
            delay: 9
        };
        let logEntries = [];

        function init() {
            loadSettings();
            showModal();
            updateLanguage();
            updateDisplay();
        }

        function showModal() {
            document.getElementById('modal').style.display = 'flex';
            document.getElementById('modal-text').innerHTML = isJapanese ?
                '目押し勢 or 新規プレイヤー<br>どちらかに該当する方のみ<br>OKボタンをタップ' :
                'For players relying on visual timing or new players only<br>Tap the OK button';
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('modal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function toggleLanguage() {
            isJapanese = !isJapanese;
            document.querySelector('.lang-toggle button').textContent = isJapanese ? 'English' : '日本語';
            updateLanguage();
            saveSettings();
        }

        function updateLanguage() {
            const texts = {
                title: isJapanese ? 'GITADORA GALAXY WAVE DELTA ドラムマニア設定ジェネレーター（非公式）' : 'GITADORA GALAXY WAVE DELTA Drummania Settings Generator (unofficial)',
                subtitle: isJapanese ? 'シャッター上部を判定ラインとして固定し、遅延を無効化します。' : 'Set the shutter top as the judgment line to disable delay.',
                bpm: isJapanese ? 'BPM' : 'BPM',
                hispeed: isJapanese ? 'HI-SPEED' : 'HI-SPEED',
                green: isJapanese ? '緑数字' : 'Green Number',
                white: isJapanese ? '白数字' : 'White Number',
                noteAdjust: isJapanese ? 'ノーツ表示調整' : 'Note Display Adjustment',
                judgeLine: isJapanese ? '判定ライン位置' : 'Judgment Line Position',
                shutterIn: isJapanese ? 'シャッター（IN）' : 'SHUTTER (IN)',
                shutterOut: isJapanese ? 'シャッター（OUT）' : 'SHUTTER (OUT)',
                refresh: isJapanese ? 'リフレッシュレート（Hz）' : 'Refresh Rate (Hz)',
                delay: isJapanese ? 'モニター遅延（ms）' : 'Monitor Delay (ms)',
                descriptionTitle: isJapanese ? '説明' : 'Description',
                descriptionText: isJapanese ?
                    'このツールは、GITADORA GALAXY WAVE DELTAドラムマニアの最適な設定を計算します。シャッター（OUT）の上部を判定ラインとして固定し、BPMに基づいてノーツ表示を調整します。緑数字と白数字はBeatmania IIDXを模倣して正確なタイミングを提供します。HI-SPEEDの上限は補間されます（BPM 78：x8.5、BPM 180：x3.75、BPM 400：x1.5）。BPM、HI-SPEED、または緑数字を調整して設定を更新します。' :
                    'This tool calculates optimal settings for GITADORA GALAXY WAVE DELTA Drummania by fixing the SHUTTER (OUT) top as the judgment line and adjusting note display based on BPM. Green and white numbers mimic Beatmania IIDX for precise timing. HI-SPEED limits are interpolated (BPM 78: x8.5, BPM 180: x3.75, BPM 400: x1.5). Adjust BPM, HI-SPEED, or green number to update settings.',
                notesTitle: isJapanese ? '注意' : 'Notes',
                note1: isJapanese ? '※コナステのHI-SPEED調整は0.5単位です。' : '* Konaste HI-SPEED adjusts in 0.5 units.',
                note2: isJapanese ? '※GITADORA GALAXY WAVE DELTAの初期出荷モニターは9msの遅延と仮定します。' : '* Assumes initial GITADORA GALAXY WAVE DELTA monitors have 9ms delay.',
                note3: isJapanese ? '※曲によって音の奥行バランスが異なるため、ヘッドホンを装着して音声遅延なしを想定します。' : '* Sound depth varies by song; use headphones for zero audio delay.',
                note4: isJapanese ? '※HI-SPEED x3.75でBPM 180はノーツがぶれない限界です。' : '* HI-SPEED x3.75 at BPM 180 is the limit for stable notes.'
            };
            document.getElementById('title').textContent = texts.title;
            document.getElementById('subtitle').textContent = texts.subtitle;
            document.getElementById('bpm-label').textContent = texts.bpm;
            document.getElementById('hispeed-label').textContent = texts.hispeed;
            document.getElementById('green-label').textContent = texts.green;
            document.getElementById('white-label').textContent = texts.white;
            document.getElementById('note-adjust-label').textContent = texts.noteAdjust;
            document.getElementById('judge-line-label').textContent = texts.judgeLine;
            document.getElementById('shutter-in-label').textContent = texts.shutterIn;
            document.getElementById('shutter-out-label').textContent = texts.shutterOut;
            document.getElementById('refresh-label').textContent = texts.refresh;
            document.getElementById('delay-label').textContent = texts.delay;
            document.getElementById('description-title').textContent = texts.descriptionTitle;
            document.getElementById('description-text').textContent = texts.descriptionText;
            document.getElementById('notes-title').textContent = texts.notesTitle;
            document.getElementById('note1').textContent = texts.note1;
            document.getElementById('note2').textContent = texts.note2;
            document.getElementById('note3').textContent = texts.note3;
            document.getElementById('note4').textContent = texts.note4;
        }

        function loadSettings() {
            const saved = localStorage.getItem('gitadoraSettings');
            if (saved) {
                settings = JSON.parse(saved);
                isJapanese = localStorage.getItem('isJapanese') === 'true';
            }
            const savedLog = localStorage.getItem('gitadoraLog');
            if (savedLog) {
                logEntries = JSON.parse(savedLog);
            }
        }

        function saveSettings() {
            localStorage.setItem('gitadoraSettings', JSON.stringify(settings));
            localStorage.setItem('isJapanese', isJapanese);
            localStorage.setItem('gitadoraLog', JSON.stringify(logEntries));
        }

        function interpolateHiSpeed(bpm) {
            const points = [
                { bpm: 78, hispeed: 8.5 },
                { bpm: 180, hispeed: 3.75 },
                { bpm: 400, hispeed: 1.5 }
            ];
            if (bpm <= 78) return 8.5;
            if (bpm >= 400) return 1.5;
            for (let i = 0; i < points.length - 1; i++) {
                if (bpm >= points[i].bpm && bpm <= points[i + 1].bpm) {
                    const t = (bpm - points[i].bpm) / (points[i + 1].bpm - points[i].bpm);
                    return points[i].hispeed + t * (points[i + 1].hispeed - points[i].hispeed);
                }
            }
            return 3.75;
        }

        function calculateSettings(trigger) {
            let { bpm, hispeed, green } = settings;
            bpm = Math.max(1, parseFloat(bpm) || 180);
            hispeed = Math.min(10, Math.max(0.5, parseFloat(hispeed) || 2.0));
            green = parseInt(green) || 357;

            // Revised green number calculation (mimicking IIDX)
            const noteInterval = (60 / bpm) * 1000 / hispeed; // Note spacing in ms
            const monitorDelay = settings.delay; // 9ms
            const timingUnit = 0.4416; // Derived from 157.67ms / 357

            if (trigger === 'bpm' || trigger === 'hispeed') {
                // Green number = (adjusted interval / timing unit)
                const adjustedInterval = noteInterval - monitorDelay;
                green = Math.round(adjustedInterval / timingUnit);
            } else if (trigger === 'green') {
                // Reverse calculate HI-SPEED from green number
                const interval = (green * timingUnit) + monitorDelay;
                hispeed = (60 / bpm) * 1000 / interval;
                hispeed = Math.round(hispeed * 4) / 4; // Round to nearest 0.25
                hispeed = Math.min(10, Math.max(0.5, hispeed));
            }

            // Calculate white number
            const white = Math.round(green * 0.7423); // Derived from 265 / 357

            // Calculate note display adjustment (-20 to +20)
            const noteAdjust = Math.round(green * -0.0125); // Scaled to hit -4 at green ≈ 357
            const noteAdjustFinal = Math.min(20, Math.max(-20, noteAdjust));

            // Calculate judgment line position (0 to 20)
            const judgeLine = Math.round(8 * (3.75 / hispeed));
            const judgeLineFinal = Math.min(20, Math.max(0, judgeLine));

            // Calculate SHUTTER (IN) (0 to 30)
            const shutterIn = Math.round(16 * (3.75 / hispeed)); // Scaled to hit 30 at HI-SPEED x2.0
            const shutterInFinal = Math.min(30, Math.max(0, shutterIn));

            settings = {
                ...settings,
                bpm,
                hispeed,
                green,
                white,
                noteAdjust: noteAdjustFinal,
                judgeLine: judgeLineFinal,
                shutterIn: shutterInFinal
            };

            // Check HI-SPEED limits
            const maxHiSpeed = interpolateHiSpeed(bpm);
            document.getElementById('hispeed-warning').textContent = hispeed > maxHiSpeed ? (isJapanese ? '要調整' : 'Adjust Required') : '';
        }

        function updateSettings(trigger) {
            const bpmInput = document.getElementById('bpm');
            const hispeedInput = document.getElementById('hispeed');
            const greenInput = document.getElementById('green');

            settings.bpm = bpmInput.value;
            settings.hispeed = hispeedInput.value;
            settings.green = greenInput.value;

            calculateSettings(trigger);
            updateDisplay();
            logChange(trigger);
            saveSettings();
        }

        function adjustValue(id, delta) {
            const input = document.getElementById(id);
            let value = parseFloat(input.value) || 0;
            value += delta;
            if (id === 'bpm') {
                value = Math.max(1, Math.round(value));
            } else if (id === 'green') {
                value = Math.round(value);
            }
            input.value = value;
            updateSettings(id);
        }

        function adjustHiSpeed(delta) {
            const input = document.getElementById('hispeed');
            let value = parseFloat(input.value) || 2.0;
            value += delta;
            value = Math.min(10, Math.max(0.5, Math.round(value * 4) / 4));
            input.value = value.toFixed(2);
            updateSettings('hispeed');
        }

        function logChange(trigger) {
            const timestamp = new Date().toLocaleString();
            const entry = `${timestamp}: ${trigger.toUpperCase()} changed - BPM: ${settings.bpm}, HI-SPEED: ${settings.hispeed}, Green: ${settings.green}`;
            logEntries.unshift(entry);
            if (logEntries.length > 10) logEntries.pop();
            document.getElementById('log').textContent = logEntries.join('\n');
        }

        function updateDisplay() {
            document.getElementById('bpm').value = settings.bpm;
            document.getElementById('hispeed').value = settings.hispeed.toFixed(2);
            document.getElementById('green').value = settings.green;
            document.getElementById('white').textContent = settings.white;
            document.getElementById('note-adjust').textContent = settings.noteAdjust;
            document.getElementById('judge-line').textContent = settings.judgeLine;
            document.getElementById('shutter-in').textContent = settings.shutterIn;
        }
    </script>
</body>
</html>
